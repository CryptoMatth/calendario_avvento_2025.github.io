<!DOCTYPE html>

<html lang="it">

	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" /> <!-- assicura che il sito sia responsivo e si adatti alla larghezza dello schermo del dispositivo. -->
		<title>Calendario dell'Avvento - Costellazioni</title>
		<script src="https://cdn.tailwindcss.com"></script> <!-- imposta il titolo della pagina che appare nella scheda del browser -->
		<link rel="stylesheet" href="utils/style.css">
	</head>

	<body class="text-white min-h-screen flex flex-col items-center p-4 overflow-y-auto relative">
		<div class="overlay"></div>
		<div class="stars" id="stars"></div>
		<div class="snow" id="snow"></div>
	  
		<!-- Main App Content -->
		<div id="mainApp" class="w-full max-w-6xl relative z-10">
			<!-- ======================================== -->
			<!-- Header -->
			<!-- ======================================== -->
			<div class="app-header">
				<div class="flex justify-center items-center">
					<div class="text-center">
						<h1 class="header-title text-4xl font-extrabold mb-2">ğŸ„ Calendario dell'Avvento - Costellazioni âœ¨</h1>
						<!-- ===== PULSANTE GUFO NATALIZIO ===== -->
						<button class="owl-button" id="owlButton" aria-label="Apri informazioni sul gioco">
						  <span>ğŸ¦‰</span>
						  <span class="owl-notification" id="owlNotification">ğŸ</span>
						  <span class="owl-notification" id="periodicNotification" style="display: none; animation: pulse-notification 0.6s infinite;">ğŸ</span>
						</button>

						<h2 id="totalScore" class="text-2xl font-semibold text-white">â­ Punteggio Totale: 0</h2>
					</div>
				</div>
			</div>
		</div>
	  
		<div id="app" class="w-full max-w-6xl relative z-10"></div>
		
		<!-- ======================================== -->
		<!-- Toast Container -->
		<!-- ======================================== -->
		<div id="toast-container"></div> <!-- questa area viene popolata dinamicamente con notifiche che appaiono in alto a destra dello schermo -->
	  
		<script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
		<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
		<script src="utils/owlNotifications.js"></script>
		<script src="utils/storageProgress.js"></script>
		<script src="utils/periodic_messages.js"></script>
		<script src="utils/constellations.js"></script>
		<script src="utils/test_questions.js"></script>
		<script src="utils/utility_functions.js"></script>
		<script src="utils/app.js"></script>

		
		<script>
			// Stelle scintillanti
			const starContainer = document.getElementById('stars');
			for (let i = 0; i < 150; i++) {
			const star = document.createElement('div');
				star.classList.add('star');
				star.style.top = Math.random() * 100 + '%';
				star.style.left = Math.random() * 100 + '%';
				starContainer.appendChild(star);
			}
			
			// Fiocchi di neve
			const snowContainer = document.getElementById('snow');
			for (let i = 0; i < 50; i++) {
				const flake = document.createElement('div');
				flake.classList.add('flake');
				flake.style.left = Math.random() * 100 + '%';
				flake.style.animationDuration = 5 + Math.random() * 5 + 's';
				flake.style.animationDelay = Math.random() * 5 + 's';
				snowContainer.appendChild(flake);
			}

			initializeOwl();
  
			const { useState, useEffect } = React;
			
			const PERIODIC_TESTS = [
				{
					testNumber: 1,
					dayRange: [1, 2, 3, 4, 5],
					daysBetween: "Tra il 5 e il 6 dicembre",
					questions: createDetailedTestQuestions([1, 2, 3, 4, 5], FULL_CONSTELLATIONS.slice(0, 5))
				},
				{
					testNumber: 2,
					dayRange: [6, 7, 8, 9, 10],
					daysBetween: "Tra il 10 e l'11 dicembre",
					questions: createTestQuestions([6, 7, 8, 9, 10], FULL_CONSTELLATIONS.slice(5, 10))
				},
				{
					testNumber: 3,
					dayRange: [11, 12, 13, 14, 15],
					daysBetween: "Tra il 15 e il 16 dicembre",
					questions: createTestQuestions([11, 12, 13, 14, 15], FULL_CONSTELLATIONS.slice(10, 15))
				},
				{
					testNumber: 4,
					dayRange: [16, 17, 18, 19, 20],
					daysBetween: "Tra il 20 e il 21 dicembre",
					questions: createTestQuestions([16, 17, 18, 19, 20], FULL_CONSTELLATIONS.slice(15, 20))
				},
				{
					testNumber: 5,
					dayRange: [21, 22, 23, 24, 25],
					daysBetween: "Tra il 25 e il 26 dicembre",
					questions: createTestQuestions([21, 22, 23, 24, 25], FULL_CONSTELLATIONS.slice(20, 25))
				},
				{
					testNumber: 6,
					dayRange: [26, 27, 28, 29, 30],
					daysBetween: "Tra il 30 e il 31 dicembre",
					questions: createTestQuestions([26, 27, 28, 29, 30], FULL_CONSTELLATIONS.slice(25, 30))
				}
			];
	  
			
			// ========================================
			// App semplificata - inizializzazione diretta
			// ========================================

		  
			// Inizializzazione semplificata
			function initializeApp() {
				console.log('ğŸš€ Inizializzando Calendario dell\'Avvento semplificato...');

				// Carica progresso dalla memoria se presente
				const progress = loadProgress();
				if (Object.keys(progress).length > 0) {
					console.log('ğŸ’¾ Progressi trovati in memoria JavaScript:', Object.keys(progress).length, 'giorni');
				}
			}
	  
			// Inizializzazione DOM semplificata
			document.addEventListener('DOMContentLoaded', function() {
				console.log('ğŸš€ DOM caricato, avvio calendario semplificato...');

				initializeApp();

				// Nascondi elementi non necessari e mostra app
				const mainApp = document.getElementById('mainApp');
				if (mainApp) {
					mainApp.style.display = 'block';
				}

				// Avvia app React direttamente
				try {
					const container = document.getElementById('app');
					if (container) {
						const root = ReactDOM.createRoot(container);
						root.render(React.createElement(App));
						console.log('âœ… App calendario inizializzata con successo');

						setTimeout(() => {
							showToast('ğŸ„ Calendario dell\'Avvento caricato! Buon divertimento!', 'success');
						}, 1000);
					}
				} catch (error) {
					console.error('âŒ Errore inizializzazione app:', error);
					showToast('Errore caricamento calendario', 'error');
				}
			});
		</script>
	</body>
</html>
